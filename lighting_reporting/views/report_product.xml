<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright NuoBiT Solutions, S.L. (<https://www.nuobit.com>)
     Eric Antones <eantones@nuobit.com>
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl) -->
<odoo>
    <template id="report_assets_common_lighting_reporting_fonts"
              name="Lighting reporting QWeb fonts" inherit_id="web.report_assets_common">
        <xpath expr="." position="inside">
            <link href="/lighting_reporting/static/src/less/styles.less" rel="stylesheet" type="text/less"/>
        </xpath>
    </template>

    <template id="external_layout_lighting">
        <!-- Multicompany -->
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>

        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>

        <div class="header">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-7">
                        <t t-foreach="doc.catalog_ids" t-as="c">
                            <img style="max-width:10%;"
                                 t-attf-src="data:image/*;base64,{{c.image}}"/>
                        </t>
                    </div>
                    <div class="col-xs-5">
                        <h4 class="text-right" t-attf-style="color: {{ brand_color }};">Datasheet</h4>
                    </div>
                </div>
            </div>
        </div>

        <div class="article o_report_layout_standard">
            <t t-raw="0"/>
        </div>

        <div class="footer">
            <div class="text-center">
                <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % to_text(company.logo)"
                     style="max-height: 30px;"/>

                <ul class="list-unstyled small mt4">
                    <li t-if="company.street or company.street2">
                        <span t-esc="' '.join(filter(lambda x: x, [company.street,company.street2]))"/>
                        <span t-esc="' '.join(filter(lambda x: x, [company.zip,company.city,company.state_id.name, company.country_id.name]))"/>
                    </li>
                    <li>
                        <t t-if="company.phone">
                            Tel.
                            <span t-field="company.phone"/>
                        </t>
                        <span t-esc="' / '.join(filter(lambda x: x, [company.email, company.website]))"/>
                    </li>
                </ul>

                <div class="text-muted">
                    Page:
                    <span class="page"/>
                    /
                    <span class="topage"/>
                </div>
            </div>
        </div>
    </template>


    <template id="report_product_document">
        <t t-call="lighting_reporting.external_layout_lighting">
            <!--t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})"/-->
            <t t-set="brand_color" t-value="'#%s' % doc.catalog_ids[0].html_color"/>
            <div class="page">
                <div class="oe_structure"/>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xs-5">
                            <div class="col-xs-12">

                                <t t-set="fimages"
                                   t-value="doc.attachment_ids.filtered(lambda x: x.type_id.code == 'F' and x.attachment_id.index_content == 'image').sorted(lambda x: (x.sequence, x.id))"/>
                                <div t-if="fimages" class="row mb32">
                                    <div class="col-xs-12">
                                        <img class="img-responsive"
                                             t-attf-src="data:image/*;base64,{{fimages[0].get_cropped_image()}}"/>
                                    </div>
                                </div>

                                <t t-set="eimages"
                                   t-value="doc.attachment_ids.filtered(lambda x: x.type_id.code == 'E' and x.attachment_id.index_content == 'image').sorted(lambda x: (x.sequence, x.id))"/>
                                <div t-if="eimages" class="row mb32">
                                    <div class="col-xs-12">
                                        <img class="img-responsive"
                                             t-attf-src="data:image/*;base64,{{eimages[0].get_cropped_image()}}"/>
                                    </div>
                                </div>

                                <t t-set="qimages"
                                   t-value="doc.attachment_ids.filtered(lambda x: x.type_id.code == 'Q' and x.attachment_id.index_content == 'image').sorted(lambda x: (x.sequence, x.id))"/>
                                <t t-set="cimages"
                                   t-value="doc.attachment_ids.filtered(lambda x: x.type_id.code == 'C' and x.attachment_id.index_content == 'image').sorted(lambda x: (x.sequence, x.id))"/>
                                <div t-if="qimages or cimages" class="row mb32">
                                    <div t-if="qimages" class="col-xs-6">
                                        <img class="img-responsive"
                                             t-attf-src="data:image/*;base64,{{qimages[0].get_cropped_image()}}"/>
                                    </div>
                                    <div t-if="cimages" class="col-xs-6">
                                        <img class="img-responsive"
                                             t-attf-src="data:image/*;base64,{{cimages[0].get_cropped_image()}}"/>
                                    </div>
                                </div>

                                <t t-set="efimages"
                                   t-value="doc.attachment_ids.filtered(lambda x: x.type_id.code == 'EF' and x.attachment_id.index_content == 'image').sorted(lambda x: (x.sequence, x.id))"/>
                                <div t-if="efimages" class="row mb32">
                                    <div class="col-xs-offset-3 col-xs-5">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <img class="img-responsive"
                                                     t-attf-src="data:image/*;base64,{{efimages[0].get_cropped_image()}}"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-7">
                            <h3 class="mt0 mb4" t-field="doc.reference"/>
                            <div class="row mb0">
                                <div class="col-xs-12">
                                    <div t-attf-style="border-bottom: 2px solid {{ brand_color }};">
                                        <h5 class="mb4">General data</h5>
                                    </div>
                                    <table class="table table-condensed mb0">

                                        <tr t-if="doc.category_id">
                                            <td>
                                                <strong>Category</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.category_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.family_ids">
                                            <td>
                                                <strong>Family</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.family_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.finish_id">
                                            <td>
                                                <strong>Finish</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.finish_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.installation_ids">
                                            <td>
                                                <strong>Installation</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.installation_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.body_material_ids">
                                            <td>
                                                <strong>Body material</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.body_material_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.diffusor_material_ids">
                                            <td>
                                                <strong>Diffuser material</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.diffusor_material_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.frame_material_ids">
                                            <td>
                                                <strong>Frame material</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.frame_material_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.reflector_material_ids">
                                            <td>
                                                <strong>Reflector material</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.reflector_material_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.blade_material_ids">
                                            <td>
                                                <strong>Blade material</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.blade_material_ids])"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div t-attf-style="border-bottom: 2px solid {{ brand_color }};">
                                        <h5 class="mb4">Light sources and beams</h5>
                                    </div>

                                    <table class="table table-condensed mb0">
                                        <tr t-if="doc.source_ids">
                                            <td>
                                                <strong>Sources</strong>
                                            </td>
                                            <td>
                                                <ul class="list-unstyled mb0">
                                                    <t t-foreach="doc.get_sheet_sources()" t-as="s">
                                                        <li t-esc="s"/>
                                                    </t>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.source_ids">
                                            <td>
                                                <strong>Lamp included</strong>
                                            </td>
                                            <td>
                                                <span t-if="doc.get_included_lamps()">
                                                    Yes
                                                </span>
                                                <span t-if="not doc.get_included_lamps()">
                                                    No
                                                </span>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.beam_ids">
                                            <td>
                                                <strong>Beams</strong>
                                            </td>
                                            <td>
                                                <ul class="list-unstyled mb0">
                                                    <t t-foreach="doc.get_sheet_beams()" t-as="b">
                                                        <li t-esc="b"/>
                                                    </t>
                                                </ul>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div t-attf-style="border-bottom: 2px solid {{ brand_color }};">
                                        <h5 class="mb4">Technical data</h5>
                                    </div>
                                    <table class="table table-condensed mb0">
                                        <!-- Description -->
                                        <tr t-if="doc.dimension_ids">
                                            <td>
                                                <strong>Dimensions</strong>
                                            </td>
                                            <td>
                                                <span t-esc="doc.dimension_ids.get_display()"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.sealing_id">
                                            <td>
                                                <strong>IP</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.sealing_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.sealing2_id">
                                            <td>
                                                <strong>IP2</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.sealing2_id"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.ik">
                                            <td>
                                                <strong>IK</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.ik"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.static_pressure">
                                            <td>
                                                <strong>Static pressure (Kg)</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.static_pressure"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.dynamic_pressure">
                                            <td>
                                                <strong>Dinamic pressure (Km/h)</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.dynamic_pressure"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.corrosion_resistance">
                                            <td>
                                                <strong>Corrosion resistance</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.corrosion_resistance"/>
                                            </td>
                                        </tr>
                                        <!-- Electric -->
                                        <tr t-if="doc.protection_class_id">
                                            <td>
                                                <strong>Protection class</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.protection_class_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.frequency_id">
                                            <td>
                                                <strong>Frequency</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.frequency_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.dimmable_ids">
                                            <td>
                                                <strong>Dimmable</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.dimmable_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.input_voltage_id">
                                            <td>
                                                <strong>Input voltage</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.input_voltage_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.input_current">
                                            <td>
                                                <strong>Input current (mA)</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.input_current"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.output_voltage_id">
                                            <td>
                                                <strong>Output voltage</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.output_voltage_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.output_current">
                                            <td>
                                                <strong>Output current (mA)</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.output_current"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.auxiliary_equipment_ids">
                                            <td>
                                                <strong>Auxiliary gear</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.auxiliary_equipment_ids])"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.usb_ports">
                                            <td>
                                                <strong>USB</strong>
                                            </td>
                                            <td>
                                                <span t-esc="doc.get_usb()"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.sensor_ids">
                                            <td>
                                                <strong>Sensors</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join([x.name for x in doc.sensor_ids])"/>
                                            </td>
                                        </tr>
                                        <!-- Physical -->
                                        <tr t-if="doc.weight">
                                            <td>
                                                <strong>Weight (Kg)</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.weight"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.cable_outlets">
                                            <td>
                                                <strong>Cable outlets</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.cable_outlets"/>
                                            </td>
                                        </tr>


                                        <tr t-if="doc.recessing_box_included">
                                            <td>
                                                <strong>Cut hole box included</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.recessing_box_included"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.recess_dimension_ids">
                                            <td>
                                                <strong>Cut hole dimensions</strong>
                                            </td>
                                            <td>
                                                <span t-esc="doc.recess_dimension_ids.get_display()"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.ecorrae_category_id">
                                            <td>
                                                <strong>ECORAEE I</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.ecorrae_category_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.ecorrae2_category_id">
                                            <td>
                                                <strong>ECORAEE II</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.ecorrae2_category_id"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.anchorage_included">
                                            <td>
                                                <strong>Anchorage included</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.anchorage_included"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.post_included">
                                            <td>
                                                <strong>Post included</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.post_included"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.post_with_inspection_chamber">
                                            <td>
                                                <strong>Post with inspection chamber</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.post_with_inspection_chamber"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.emergency_light">
                                            <td>
                                                <strong>Emergency light</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.emergency_light"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.mechanical_screwdriver">
                                            <td>
                                                <strong>Electric screwdriver</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.mechanical_screwdriver"/>
                                            </td>
                                        </tr>
                                        <tr t-if="doc.fan_blades">
                                            <td>
                                                <strong>Fan blades</strong>
                                            </td>
                                            <td>
                                                <span t-field="doc.fan_blades"/>
                                            </td>
                                        </tr>

                                        <tr t-if="doc.fan_wattage_ids">
                                            <td>
                                                <strong>Fan wattages</strong>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join(['%gW' % x.wattage for x in doc.fan_wattage_ids])"/>
                                            </td>
                                        </tr>

                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="oe_structure"/>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="report_product">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <!--t t-call="lighting_portal_product_report.report_portalproduct" t-lang="doc.partner_id.lang"/-->
                <t t-call="lighting_reporting.report_product_document"/>
            </t>
        </t>
    </template>
</odoo>